<!DOCTYPE html>
<html
  lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://thymeleaf.org"
>
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
    <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <title>SIPP - PRORORO</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
  </head>

  <body>
    <div class="container-fluid">
      <div class="row">
        <!--        <div th:replace=~{"fragments/sidebarf :: sidebar}" class="col-lg-3 col-md-4" ></div>-->
        <div th:replace="~{fragments/sidebarf}" class="col-lg-3 col-md-4"></div>
        <div class="col">
          <div class="card m-4 p-4">
            <div style="text-align: center">
              <img
                src="https://gitlab.cs.ui.ac.id/propensi-2023-2024-genap/kelas-c/c06-prororo/-/raw/main/images/logo.png?ref_type=heads"
                alt="prororo"
                style="width: 100px; height: 100px"
              />

              <br /><br />

              <p>hello world this is prororo hihuhe</p>
              <br />
              <p>
                our amazing sipp information system for pt bumi karsa is coming
                soon!
              </p>
              <a href="/rencana/" class="btn btn-primary">daftar rencana</a>
              <a href="/rencana/create" class="btn btn-primary">add rencana</a>
              <a href="/barang" class="btn btn-primary">Daftar barang</a>
              <a href="/barang/tambah" class="btn btn-primary">Add barang</a>
              <a href="/vendor/tambah" class="btn btn-primary">add vendor</a>
              <a href="/vendor" class="btn btn-primary"> list vendor</a>
              <a href="/pengadaan" class="btn btn-primary"> Daftar Pengadaan</a>
              <a href="/pengadaan/tambah" class="btn btn-primary"
                >Add Pengadaan</a
              >
              <a href="/logout" class="btn btn-primary">Logout</a>
              <!-- <a href="/user" class="btn btn-primary">View All User</a>
              <a href="/user" class="btn btn-primary">View All User</a>
              <a href="/user" class="btn btn-primary">View All User</a>
              <a href="/user" class="btn btn-primary">View All User</a>
              <a href="/user" class="btn btn-primary">View All User</a>
              <a href="/user" class="btn btn-primary">View All User</a>
              <a href="/user" class="btn btn-primary">View All User</a> -->
              <p>stay tuned x</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700&display=swap" rel="stylesheet">
  <title>Dashboard Pengadaan</title>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <div class="col">
      <div class="container">
        <div class="card m-4 p-4 shadow-lg p-3 mb-5 bg-white rounded">
          <div class="card-body">
            <div class="row">
              <div class="col-md-6">
                <div class="text-center">
                  <h2>Pengadaan</h2>
                </div>
                <canvas id="monthlyExpenditureChart" width="800" height="400"></canvas>
              </div>
              <div class="col-md-6">
                <div class="text-center">
                  <h4>Pengeluaran Pertahun</h4>
                  <div class="card">
                    <div class="card-body">
                      <p class="card-text">Total Pengeluaran Tahunan: <span th:text="${totalPengeluaranTahunan}"></span></p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="text-center">
                      <h4>Pengadaan</h4>
                      <div class="card">
                        <div class="card-body">
                          <p class="card-text">Total Pengadaan: <span th:text="${totalPengadaan} + ' unit'"></span></p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  $(document).ready(function () {
    // Lakukan fetch ke endpoint API
    fetch('/api/pengadaan/view-all')
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json(); // Parse response ke JSON
            })
            .then(data => {
              const labels = Object.keys(data); // Ambil label dari keys object
              const dataValues = Object.values(data); // Ambil data dari values object

              // Pastikan semua data adalah finite number
              const cleanedDataValues = dataValues.map(value =>
                      (typeof value === 'number' && isFinite(value)) ? value : 0
              );

              // Ambil context dari canvas untuk Chart
              var ctx = document.getElementById('monthlyExpenditureChart').getContext('2d');

              // Buat Chart
              var monthlyExpenditureChart = new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: labels,
                  datasets: [{
                    label: 'Total Pengeluaran Bulanan',
                    data: cleanedDataValues,
                    backgroundColor: [
                      'rgba(255, 99, 132, 0.2)',
                      'rgba(54, 162, 235, 0.2)',
                      'rgba(255, 206, 86, 0.2)',
                      'rgba(75, 192, 192, 0.2)',
                      'rgba(153, 102, 255, 0.2)',
                      'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                      'rgba(255, 99, 132, 1)',
                      'rgba(54, 162, 235, 1)',
                      'rgba(255, 206, 86, 1)',
                      'rgba(75, 192, 192, 1)',
                      'rgba(153, 102, 255, 1)',
                      'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                  }]
                },
                options: {
                  scales: {
                    y: {
                      beginAtZero: true
                    }
                  }
                }
              });
            })
            .catch(error => {
              console.error('Error fetching data:', error);
            });
  });
</script>
</body>
</html>

<!--<!DOCTYPE html>-->
<!--<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thymeleaf.org">-->
<!--<head>-->
<!--  <meta charset="UTF-8" />-->
<!--  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />-->
<!--  <link href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css" rel="stylesheet" />-->
<!--  <title>Dashboard Pengadaan</title>-->
<!--</head>-->
<!--<body>-->
<!--<div class="container-fluid">-->
<!--  <div class="row">-->
<!--    <div th:replace="~{fragments/sidebarf}" class="col-lg-3 col-md-4"></div>-->
<!--    <div class="col">-->
<!--      <div class="container">-->
<!--        <div class="card m-4 p-4 shadow-lg p-3 mb-5 bg-white rounded">-->
<!--          <div class="card-body">-->
<!--            <div class="text-center">-->
<!--              <h2>Pengadaan</h2>-->
<!--            </div>-->
<!--            <canvas id="monthlyExpenditureChart" width="800" height="400"></canvas>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->

<!--<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>-->
<!--<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>-->
<!--<script>-->
<!--  $(document).ready(function () {-->
<!--    fetch('/api/pengadaan/view-all') // Ganti dengan URL endpoint API Anda-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--              const labels = Object.keys(data);-->
<!--              const dataValues = Object.values(data);-->

<!--              // Pembersihan data jika terdapat nilai negatif atau tidak valid-->
<!--              for (let i = 0; i < dataValues.length; i++) {-->
<!--                if (dataValues[i] < 0 || !isFinite(dataValues[i])) {-->
<!--                  dataValues[i] = 0; // Set nilai negatif atau infinity menjadi 0-->
<!--                }-->
<!--              }-->

<!--              // Buat array of gradient objects-->
<!--              var gradientObjects = [];-->
<!--              var bar_ctx = document.getElementById('monthlyExpenditureChart').getContext('2d');-->

<!--              // Buat gradient objects sesuai kebutuhan-->
<!--              var backgrounds = ['red', 'green', 'orange', 'green'];-->
<!--              for (let i = 0; i < backgrounds.length; i++) {-->
<!--                var gradient = bar_ctx.createLinearGradient(0, 0, 0, 600);-->
<!--                gradient.addColorStop(0, backgrounds[i]);-->
<!--                gradient.addColorStop(1, 'blue');-->
<!--                gradientObjects.push(gradient);-->
<!--              }-->

<!--              // Buat chart menggunakan Chart.js dengan multiple colors for bars-->
<!--              var ctx = document.getElementById('monthlyExpenditureChart').getContext('2d');-->
<!--              var monthlyExpenditureChart = new Chart(ctx, {-->
<!--                type: 'bar',-->
<!--                data: {-->
<!--                  labels: labels,-->
<!--                  datasets: [{-->
<!--                    label: 'Total Pengeluaran Bulanan',-->
<!--                    data: dataValues,-->
<!--                    backgroundColor: gradientObjects,-->
<!--                    borderColor: 'rgba(255, 206, 86, 1)',-->
<!--                    borderWidth: 1-->
<!--                  }]-->
<!--                },-->
<!--                options: {-->
<!--                  scales: {-->
<!--                    y: {-->
<!--                      beginAtZero: true-->
<!--                    }-->
<!--                  }-->
<!--                }-->
<!--              });-->
<!--            })-->
<!--            .catch(error => {-->
<!--              console.error('Error fetching data: ', error);-->
<!--            });-->
<!--  });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

